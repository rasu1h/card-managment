# üöÄ –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏

Backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Java (Spring Boot) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏: —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–∞–º–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä, –ø–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É —Å–≤–æ–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏.

## üìã –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Java 17+**
- **Spring Boot 3.2**
- **Spring Security + JWT**
- **Spring Data JPA**
- **PostgreSQL**
- **Liquibase** ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- **Docker Compose** ‚Äî dev-—Å—Ä–µ–¥–∞
- **Swagger/OpenAPI** ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Java 17+
- Maven 3.8+
- Docker –∏ Docker Compose (–¥–ª—è –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ Docker)

## üèÉ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Compose ‚Äî –ø–æ–ª–Ω—ã–π —Å—Ç–µ–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ó–∞–ø—É—Å–∫ PostgreSQL –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π (JAR —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Docker):

```bash
git clone <url-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è>
cd bank_rest

docker-compose up -d --build
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:8080**  
Swagger UI: **http://localhost:8080/swagger**

### –í–∞—Ä–∏–∞–Ω—Ç 1–±: Docker Compose ‚Äî —Ç–æ–ª—å–∫–æ PostgreSQL

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ Maven:

```bash
docker-compose up -d postgres
# –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5‚Äì10 —Å–µ–∫, –∑–∞—Ç–µ–º:
mvn spring-boot:run
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–∞—è PostgreSQL

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL.
2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
   ```sql
   CREATE DATABASE bank;
   ```
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `application.yml` (–∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è):
   ```yaml
   spring:
     datasource:
       url: jdbc:postgresql://localhost:5432/bank
       username: postgres
       password: <–≤–∞—à-–ø–∞—Ä–æ–ª—å>
   ```
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   ```bash
   mvn spring-boot:run
   ```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
export SPRING_DATASOURCE_URL=jdbc:postgresql://localhost:5432/bank
export SPRING_DATASOURCE_USERNAME=postgres
export SPRING_DATASOURCE_PASSWORD=your_password
export JWT_SECRET=your-base64-secret-key
export CRYPTO_AES_KEY=your-32-char-aes-key
mvn spring-boot:run
```

### ‚ö†Ô∏è –û—à–∏–±–∫–∞ ¬´–æ—Ç–Ω–æ—à–µ–Ω–∏–µ "users" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç¬ª

–ï—Å–ª–∏ –ë–î –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ —Ä–∞–Ω–µ–µ —á–µ—Ä–µ–∑ Hibernate (`ddl-auto: update`), Liquibase –º–æ–∂–µ—Ç –≤—ã–¥–∞—Ç—å –æ—à–∏–±–∫—É. –†–µ—à–µ–Ω–∏—è:

**–í–∞—Ä–∏–∞–Ω—Ç A** ‚Äî —Å–±—Ä–æ—Å–∏—Ç—å –ë–î (Docker):
```bash
docker-compose down -v
docker-compose up -d
mvn spring-boot:run
```

**–í–∞—Ä–∏–∞–Ω—Ç B** ‚Äî –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É –≤—Ä—É—á–Ω—É—é:
```sql
DROP DATABASE bank;
CREATE DATABASE bank;
```

–ó–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

**–í–∞—Ä–∏–∞–Ω—Ç C** ‚Äî –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
mvn clean compile
```

## üìö API –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **Swagger UI**: http://localhost:8080/swagger
- **OpenAPI JSON**: http://localhost:8080/v3/api-docs
- **OpenAPI YAML**: `docs/openapi.yaml`

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫:
```
Authorization: Bearer <JWT-—Ç–æ–∫–µ–Ω>
```

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| POST | `/auth/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| POST | `/auth/register/admin` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–¥) |
| POST | `/auth/login` | –í—Ö–æ–¥ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT) |

### –†–æ–ª–∏

- **ADMIN** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ/–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞/–∞–∫—Ç–∏–≤–∞—Ü–∏—è/—É–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç, –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞, –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫–∞—Ä—Ç
- **USER** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –∫–∞—Ä—Ç, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–≤–æ–µ–π –∫–∞—Ä—Ç—ã, –ø–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É —Å–≤–æ–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä –±–∞–ª–∞–Ω—Å–∞

## üß™ –¢–µ—Å—Ç—ã

```bash
# –ü–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ testcontainers)
docker-compose up -d postgres

# –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
mvn test -Dtest=BankCardsIntegrationTest

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
mvn test
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ—Ñ–∏–ª—å `test` –∏ H2/PostgreSQL –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
bank_rest/
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ openapi.yaml       # OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îú‚îÄ‚îÄ src/main/
‚îÇ   ‚îú‚îÄ‚îÄ java/.../bankcards/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controller/    # REST-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service/       # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entity/        # JPA-—Å—É—â–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repository/    # Spring Data JPA
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security/      # JWT, Security
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ util/          # –£—Ç–∏–ª–∏—Ç—ã (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ)
‚îÇ   ‚îî‚îÄ‚îÄ resources/
‚îÇ       ‚îú‚îÄ‚îÄ application.yml
‚îÇ       ‚îî‚îÄ‚îÄ db/migration/  # Liquibase –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ pom.xml
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|
| `server.port` | –ü–æ—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | 8080 |
| `spring.datasource.url` | URL PostgreSQL | jdbc:postgresql://localhost:5432/bank |
| `jwt.secret` | –°–µ–∫—Ä–µ—Ç –¥–ª—è JWT (Base64) | ‚Äî |
| `crypto.aes-key` | –ö–ª—é—á AES –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç (32 —Å–∏–º–≤–æ–ª–∞) | ‚Äî |
| `app.admin.registration.code` | –ö–æ–¥ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∞ | ADMIN_SECRET_2024 |

## üì§ –§–æ—Ä–º–∞—Ç —Å–¥–∞—á–∏

–ü—Ä–æ–µ–∫—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –¥–æ—Å—Ç—É–ø–æ–º. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ –¥—Ä—É–≥–æ–º –≤–∏–¥–µ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è.
